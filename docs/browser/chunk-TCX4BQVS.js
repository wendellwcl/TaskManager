import{$ as N,V as E,d as e,e as c,f as g,g as h,n as L,ya as O}from"./chunk-MCPLFIMF.js";var S=function(o){return o.PENDING="pending",o.COMPLETED="completed",o.DELETED="deleted",o}(S||{});var B=(()=>{let a=class a{constructor(){this.storageEvent=new Event("storage")}getLocalStorageItem(r){let n=localStorage.getItem(r);return n?JSON.parse(n):null}setLocalStorageItem(r,n){let u=JSON.stringify(n);localStorage.setItem(r,u),window.dispatchEvent(this.storageEvent)}};a.\u0275fac=function(n){return new(n||a)},a.\u0275prov=E({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();var W=(()=>{var a,d,r,n,u,p,k,I,x,b,P,v,$,w,G,D,A,j,F,m,y;let f=class f{constructor(){c(this,I);c(this,b);c(this,v);c(this,w);c(this,D);c(this,j);c(this,m);c(this,a,void 0);c(this,d,void 0);c(this,r,void 0);c(this,n,void 0);c(this,u,void 0);c(this,p,void 0);c(this,k,void 0);g(this,a,N(B)),g(this,d,O(null)),g(this,r,new L([])),g(this,n,new L([])),this.getListToRender$=e(this,n).asObservable(),g(this,u,new L([])),this.getTasksSubjects$=e(this,u).asObservable(),g(this,p,new L([])),this.getDeadlineTasks$=e(this,p).asObservable(),g(this,k,new L([])),this.getTasksHistory$=e(this,k).asObservable(),h(this,I,x).call(this),window.addEventListener("storage",()=>{h(this,I,x).call(this)})}addNewTaskToLocalStorage(t){let i=[...e(this,r).value,t];e(this,a).setLocalStorageItem("tasksList",i)}createNewTask(t){let s={id:new Date().getTime(),title:t.title,subject:t.subject,description:t.description,priority:t.priority,deadlineDate:t.deadlineDate,creationDate:new Date().toISOString().split("T")[0],status:S.PENDING};this.addNewTaskToLocalStorage(s)}updateTask(t,s){for(let i of e(this,r).value)i.id===t&&(i.title=s.title,i.subject=s.subject,i.description=s.description,i.priority=s.priority,i.deadlineDate=s.deadlineDate);e(this,a).setLocalStorageItem("tasksList",e(this,r).value)}completeOrDeleteTask(t,s){let i=this.getTaskById(t);switch(s){case"complete":i.status=S.COMPLETED,h(this,m,y).call(this,t,"tasksList","tasksHistoric",i);break;case"delete":i.status=S.DELETED,h(this,m,y).call(this,t,"tasksList","tasksHistoric",i);break;default:break}}restoreTask(t){let s=this.getTaskById(t);s.status=S.PENDING,h(this,m,y).call(this,t,"tasksHistoric","tasksList",s)}clearHistory(){e(this,a).setLocalStorageItem("tasksHistoric",[])}getTaskById(t){let s=Number(t),i=e(this,r).value.filter(l=>l.id===s);return i.length===0&&(i=e(this,k).value.filter(l=>l.id===s)),i[0]}getTasksBySearch(t){if(!t){e(this,n).next(e(this,r).value),e(this,d).set(null);return}e(this,d).set(t);let s=new RegExp(`^${t}`,"i"),i=e(this,r).value.filter(l=>s.test(l.title)||s.test(l.subject));e(this,n).next(i)}};a=new WeakMap,d=new WeakMap,r=new WeakMap,n=new WeakMap,u=new WeakMap,p=new WeakMap,k=new WeakMap,I=new WeakSet,x=function(){h(this,b,P).call(this),h(this,v,$).call(this),h(this,w,G).call(this),h(this,D,A).call(this)},b=new WeakSet,P=function(){let t=e(this,a).getLocalStorageItem("tasksList");t&&(e(this,r).next(t),e(this,d).call(this)?this.getTasksBySearch(e(this,d).call(this)):e(this,n).next(t))},v=new WeakSet,$=function(){let s=e(this,r).value.map(T=>T.subject),l=[...new Set(s.filter(T=>T!==null))];e(this,u).next(l)},w=new WeakSet,G=function(){let t=new Date().toISOString().split("T")[0],s=e(this,r).value.filter(i=>i.deadlineDate==t);e(this,p).next(s)},D=new WeakSet,A=function(){let t=e(this,a).getLocalStorageItem("tasksHistoric");t&&e(this,k).next(t)},j=new WeakSet,F=function(t,s){let l=e(this,a).getLocalStorageItem(s).filter(T=>T.id!==t);e(this,a).setLocalStorageItem(s,l)},m=new WeakSet,y=function(t,s,i,l){let T=this.getTaskById(t),H=e(this,a).getLocalStorageItem(i)||[];l?e(this,a).setLocalStorageItem(i,[...H,l]):e(this,a).setLocalStorageItem(i,[...H,T]),h(this,j,F).call(this,t,s)},f.\u0275fac=function(s){return new(s||f)},f.\u0275prov=E({token:f,factory:f.\u0275fac,providedIn:"root"});let o=f;return o})();var C=function(o){return o.DEFAULT="Padr\xE3o",o.HIGH="Alta",o}(C||{});export{S as a,W as b,C as c};
